# Донавчання детектора об'єктів на датасеті ArTaxOr

Цей проект містить Kaggle notebook для донавчання моделі детекції об'єктів YOLOv8 на датасеті [ArTaxOr (Arthropod Taxonomy Orders Object Detection Dataset)](https://www.kaggle.com/datasets/mistag/arthropod-taxonomy-orders-object-detection-dataset) з Kaggle.

## Використання на Kaggle

### 1. Завантаження notebook

1. Завантажте файл `artaxor_training.ipynb` на Kaggle
2. Створіть новий notebook або завантажте існуючий

### 2. Додавання датасету

1. У вашому Kaggle notebook натисніть кнопку **"Add Data"** (або **"+ Add data"**)
2. У пошуку введіть: `arthropod-taxonomy-orders-object-detection-dataset`
3. Знайдіть датасет від користувача `mistag` та натисніть **"Add"**

### 3. Запуск notebook

1. Запустіть всі комірки послідовно (Cell → Run All)
2. Або запускайте комірки по одній для кращого контролю

### 4. Налаштування параметрів

У комірці **"7. Навчання моделі YOLOv8"** можна змінити параметри:

```python
MODEL_SIZE = 'n'  # n, s, m, l, x (nano, small, medium, large, xlarge)
EPOCHS = 100       # Кількість епох навчання
IMG_SIZE = 640    # Розмір зображення для навчання
BATCH_SIZE = 16   # Розмір батчу (залежить від доступної пам'яті GPU)
```

## Структура notebook

Notebook містить наступні розділи:

1. **Встановлення залежностей** - автоматичне встановлення необхідних бібліотек
2. **Імпорт бібліотек** - імпорт всіх необхідних модулів
3. **Завантаження датасету** - автоматична перевірка наявності датасету
4. **Функції для конвертації** - функції для конвертації Pascal VOC та COCO у формат YOLO
5. **Конвертація датасету** - автоматична конвертація та розподіл на train/val/test
6. **Перевірка структури** - валідація конвертованого датасету
7. **Навчання моделі** - донавчання YOLOv8 з налаштуваннями
8. **Результати навчання** - метрики та графіки результатів
9. **Валідація моделі** (опціонально) - оцінка на валідаційному наборі
10. **Тестування** (опціонально) - приклад використання на тестовому зображенні

## Підтримувані формати датасету

Notebook автоматично визначає та підтримує:
- **Pascal VOC** (XML файли)
- **COCO** (JSON файли)

## Результати навчання

Після навчання результати зберігаються в `/kaggle/working/artaxor_training/`:
- `weights/best.pt` - найкраща модель за метрикою mAP
- `weights/last.pt` - остання модель
- `results.png` - графіки з метриками навчання
- `confusion_matrix.png` - матриця плутанини
- `*.jpg` - приклади валідації

## Примітки

- Для кращих результатів рекомендується використовувати GPU на Kaggle
- Розмір батчу залежить від доступної пам'яті GPU (за замовчуванням 16)
- Моделі більшого розміру (l, x) потребують більше пам'яті та часу навчання
- Рекомендується почати з моделі `n` (nano) для швидкого тестування
- Датасет автоматично конвертується у формат YOLO з розподілом 80% train / 10% val / 10% test

## Додаткові ресурси

- [YOLOv8 Documentation](https://docs.ultralytics.com/)
- [Kaggle Dataset](https://www.kaggle.com/datasets/mistag/arthropod-taxonomy-orders-object-detection-dataset)
- [Ultralytics GitHub](https://github.com/ultralytics/ultralytics)
